# ZEONE Whitepaper

## Аннотация

Современная интернет-инфраструктура построена на централизованных протоколах (BGP, DNS, CA), которые создают единые точки отказа и позволяют государственным акторам осуществлять массовую слежку и цензуру. ZEONE — децентрализованная операционная система, реализующая парадигму Compute-over-Data: вычисления перемещаются к данным, а не наоборот. Система объединяет P2P-транспорт, распределённый AI-инференс (Cortex), VPN-маршрутизацию и криптоэкономику в единый суверенный сетевой слой.

---

## 1. Философия и ландшафт угроз

### 1.1 Уязвимости BGP

Border Gateway Protocol (RFC 4271) — протокол междоменной маршрутизации, на котором держится весь интернет. Его фундаментальные проблемы:

**BGP Hijacking:**
Любая автономная система (AS) может анонсировать чужие IP-префиксы. Верификация происхождения маршрутов (RPKI) внедрена менее чем на 40% сетей. Атакующий может:
- Перенаправить трафик через свою AS для перехвата
- Создать "чёрную дыру" (blackhole) для DoS
- Выполнить MITM на незашифрованных соединениях

**AS-Path Manipulation:**
BGP доверяет атрибуту AS_PATH без криптографической верификации. Атакующий может:
- Укоротить путь для привлечения трафика
- Добавить ложные AS для обхода фильтров
- Использовать BGP communities для манипуляции политиками

**Примеры инцидентов:**
- 2018: Amazon Route 53 hijack для кражи $150K в криптовалюте
- 2022: Russia Telecom перенаправление трафика Twitter/Facebook

### 1.2 Проблемы DNS

Domain Name System (RFC 1035) — иерархическая система с корневыми серверами под контролем ICANN.

**Централизация корневых серверов:**
13 корневых серверов (A-M) контролируются организациями преимущественно из США. Теоретически возможно:
- Удаление TLD по политическим мотивам
- Принудительное перенаправление доменов
- Массовая деанонимизация через логи DNS-запросов

**Cache Poisoning (RFC 5452):**
Атакующий может внедрить ложные записи в DNS-кэш резолвера:
```
Query ID: 16-bit (65536 вариантов)
Source Port: часто предсказуем
→ Birthday attack: ~256 пакетов для 50% успеха
```

**DNS-over-HTTPS (DoH) ≠ решение:**
DoH шифрует канал, но централизует резолверы (Cloudflare 1.1.1.1, Google 8.8.8.8). Провайдер DoH получает полный граф посещений пользователя.

### 1.3 Риски Certificate Authorities

PKI (Public Key Infrastructure) построена на доверии к ~150 корневым CA.

**Компрометация CA:**
- 2011: DigiNotar — выпущены поддельные сертификаты для *.google.com
- 2015: CNNIC — подчинённый CA выпускал MITMing сертификаты
- 2016: WoSign — бэкдейтинг сертификатов

**State-level MITM:**
Государства могут принудить национальные CA выпустить сертификат для любого домена. Certificate Transparency (CT) логи обнаруживают это постфактум, но не предотвращают.

**Проблема отзыва:**
OCSP/CRL проверяются не всегда (soft-fail по умолчанию). Браузеры кэшируют статус, создавая окно уязвимости.

### 1.4 Решение ZEONE

ZEONE устраняет зависимость от централизованных протоколов:

| Проблема | Традиционное решение | ZEONE |
|----------|---------------------|-------|
| Маршрутизация | BGP (trust-based) | Kademlia DHT (cryptographic) |
| Именование | DNS (hierarchical) | Content-addressing (SHA-256) |
| Идентичность | CA (delegated trust) | Ed25519 keypairs (self-sovereign) |
| Шифрование | TLS (CA-dependent) | NaCl Box (peer-to-peer) |

---

## 2. Математика Trust Score

### 2.1 Текущая реализация

Trust Score \( T \in [0, 1] \) — локальная метрика репутации пира, вычисляемая каждым узлом независимо.

**Базовая формула обновления:**

$$
T_{new} = \text{clamp}(T_{old} + w_e \cdot m, 0, 1)
$$

где:
- \( w_e \) — вес события \( e \) из таблицы
- \( m \) — magnitude (например, размер транзакции в MB)
- \( \text{clamp}(x, a, b) = \max(a, \min(b, x)) \)

**Таблица весов событий:**

| Событие | Вес \( w_e \) | Описание |
|---------|---------------|----------|
| `successful_transfer` | +0.01 | Успешная передача данных |
| `failed_transfer` | -0.05 | Неудачная передача |
| `valid_message` | +0.001 | Валидное подписанное сообщение |
| `invalid_message` | -0.02 | Невалидная подпись |
| `iou_created` | +0.005 | Создан IOU |
| `iou_redeemed` | +0.02 | IOU погашен |
| `iou_defaulted` | -0.1 | IOU просрочен |
| `ping_responded` | +0.001 | Ответил на PING |
| `ping_timeout` | -0.01 | Не ответил на PING |
| `debt_repaid` | +0.02 | Долг погашен |
| `excessive_debt` | -0.03 | Превышен лимит долга |

### 2.2 Decay за неактивность

Репутация деградирует экспоненциально при отсутствии взаимодействий:

$$
T_{decayed} = T \cdot 0.99^{d}
$$

где \( d \) — количество дней неактивности.

**Период полураспада:** \( t_{1/2} = \frac{\ln 2}{\ln(1/0.99)} \approx 69 \) дней.

### 2.3 [PROPOSED] EMA-формула

Для более плавного обновления предлагается Exponential Moving Average:

$$
T_{new} = \alpha \cdot R + (1 - \alpha) \cdot T_{old}
$$

где:
- \( R \in [0, 1] \) — результат последнего взаимодействия (1 = успех, 0 = провал)
- \( \alpha \in (0, 1) \) — коэффициент сглаживания (рекомендуется 0.1)

**Преимущества EMA:**
- Естественное ограничение \( T \in [0, 1] \) без clamp
- Экспоненциальное забывание старых событий
- Параметр \( \alpha \) контролирует "память" системы

### 2.4 Начальное значение и Cold Start

Новые пиры получают:
- \( T_0 = 0.5 \) (нейтральный)
- Минимальный порог взаимодействия: \( T_{min} = 0.1 \)

**Cold Start Protection:**
Пир с \( T < T_{min} \) может только:
1. Отвечать на PING (доказательство liveness)
2. Участвовать в DHT routing
3. Создавать IOU с высоким залогом

---

## 3. Токеномика [PROPOSED]

### 3.1 Токен ZEO

- **Стандарт:** ERC-20 (совместимость с EVM-цепями)
- **Начальная эмиссия:** 100,000,000 ZEO
- **Decimals:** 18

### 3.2 Кривая эмиссии

Предлагается логарифмическая кривая с асимптотическим пределом:

$$
S(t) = S_{max} \cdot \left(1 - e^{-\lambda t}\right)
$$

где:
- \( S(t) \) — общее предложение в момент \( t \)
- \( S_{max} = 1,000,000,000 \) ZEO — максимальное предложение
- \( \lambda = 0.1 \) год⁻¹ — скорость эмиссии

**Эмиссия в год \( n \):**

$$
\Delta S_n = S_{max} \cdot e^{-\lambda n} \cdot (1 - e^{-\lambda})
$$

| Год | Эмиссия (M ZEO) | Cumulative (M ZEO) |
|-----|-----------------|---------------------|
| 1   | 95.16           | 95.16               |
| 2   | 86.07           | 181.23              |
| 3   | 77.86           | 259.09              |
| 5   | 63.76           | 393.47              |
| 10  | 40.66           | 632.12              |

### 3.3 Механизм сжигания

При каждой транзакции услуг (VPN, CDN, AI) часть комиссии сжигается:

$$
\text{burn} = \text{fee} \cdot \beta
$$

где \( \beta = 0.2 \) (20% комиссии сжигается).

**Дефляционное давление:**
При высокой утилизации сети сжигание может превысить эмиссию, создавая дефляционную динамику.

### 3.4 Staking для Exit-узлов

VPN Exit и CDN Provider узлы должны застейкать ZEO:

$$
\text{stake}_{min} = \text{bandwidth}_{Mbps} \cdot k_{stake}
$$

где \( k_{stake} = 100 \) ZEO/Mbps.

**Slashing условия:**
- Неверные данные (hash mismatch): -10% stake
- Недоступность > 1 час: -1% stake
- Цензура контента: -50% stake + бан

---

## 4. Модель угроз

### 4.1 Sybil Attack

**Описание:** Атакующий создаёт множество фальшивых идентичностей для захвата контроля над сетью.

**Защита в ZEONE:**

1. **Стоимость идентичности:**
   - Генерация Ed25519 keypair: ~0.1ms на современном CPU
   - Недостаточно для экономического барьера

2. **Trust Score cold start:**
   - Новые узлы начинают с \( T_0 = 0.5 \)
   - Требуется время для накопления репутации
   - Sybil-узлы не могут мгновенно получить влияние

3. **[PROPOSED] Stake requirement:**
   - Для участия в DHT routing: минимальный stake 10 ZEO
   - Для предоставления услуг: stake пропорционален bandwidth

**Эффективность:**
При stake requirement = 10 ZEO и цене 1 ZEO = $0.10:
- Стоимость 1000 Sybil-узлов: $1,000
- Стоимость атаки на сеть с 10,000 узлов (>50%): $50,000+

### 4.2 Eclipse Attack

**Описание:** Атакующий изолирует жертву, заполняя её routing table вредоносными узлами.

**Защита в ZEONE (Kademlia):**

1. **K-bucket diversity:**
   - \( K = 20 \) узлов на bucket
   - 160 buckets → до 3200 уникальных узлов в таблице
   - Атакующему нужно контролировать узлы во всех релевантных buckets

2. **Random bucket refresh:**
   - Каждый час: lookup случайного ID в каждом bucket
   - Обновляет таблицу узлами из разных частей ID-пространства

3. **LRU с проверкой:**
   - При переполнении bucket: PING самого старого узла
   - Новый узел вытесняет только если старый не отвечает
   - Защита от вытеснения легитимных узлов

**Математика атаки:**
Для eclipse с вероятностью \( p \):
- Нужно контролировать \( \geq K \cdot \log_2(N) \) узлов
- При \( N = 10000, K = 20 \): ~266 узлов для частичного eclipse

### 4.3 Free-riding (Leeching)

**Описание:** Узел потребляет ресурсы сети, не предоставляя ничего взамен.

**Защита в ZEONE:**

1. **Ledger blocking:**
   ```python
   debt_limit = 100 * 1024 * 1024  # 100 MB
   
   if balance[peer] > debt_limit:
       block_sending_to(peer)
   ```

2. **Tit-for-Tat в Amplifier:**
   - Узел A отдаёт chunk узлу B
   - B должен A эквивалентный объём
   - При превышении лимита: B блокируется до погашения

3. **Trust Score penalty:**
   - `excessive_debt`: -0.03 к Trust Score
   - При \( T < 0.1 \): узел не может запрашивать данные

### 4.4 Replay Attack

**Описание:** Атакующий перехватывает и повторно отправляет валидное сообщение.

**Защита:**

1. **Timestamp validation:**
   ```python
   MAX_MESSAGE_AGE = 60  # секунд
   if time.time() - message.timestamp > MAX_MESSAGE_AGE:
       reject(message)
   ```

2. **Nonce uniqueness:**
   - Каждое сообщение содержит 16-byte random nonce
   - Узел хранит seen nonces в bloom filter (1 час TTL)
   - Повторный nonce → отклонение

3. **Session keys:**
   - После handshake: уникальный session key через ECDH
   - Сообщения привязаны к сессии

---

## 5. Governance [PROPOSED]

### 5.1 DAO-структура

Управление параметрами сети через децентрализованное голосование:

**Управляемые параметры:**
- Комиссии: `fee_vpn`, `fee_cdn`, `fee_ai`
- Лимиты: `debt_limit`, `max_stake`
- Политики: `min_trust_score`, `slashing_rate`
- Whitelist моделей для Cortex

### 5.2 Механизм голосования

**Вес голоса:**

$$
V = \sqrt{S} \cdot (1 + T)
$$

где:
- \( S \) — stake в ZEO
- \( T \) — Trust Score

**Квадратный корень** от stake предотвращает плутократию.

**Процесс:**
1. Proposal submission: требует 1000 ZEO deposit
2. Discussion period: 7 дней
3. Voting period: 7 дней
4. Execution delay: 2 дня (для exit)

---

## Заключение

ZEONE предлагает фундаментально новую архитектуру интернета, устраняющую зависимость от централизованных точек доверия. Криптографическая идентичность, экономические стимулы и распределённое хранение создают устойчивую к цензуре инфраструктуру для вычислений, коммуникаций и хранения данных.

---

## Ссылки

1. RFC 4271 — A Border Gateway Protocol 4 (BGP-4)
2. RFC 1035 — Domain Names - Implementation and Specification
3. RFC 5452 — Measures for Making DNS More Resilient against Forged Answers
4. Maymounkov, P., Mazières, D. — Kademlia: A Peer-to-peer Information System Based on the XOR Metric
5. Bernstein, D.J. — Curve25519: new Diffie-Hellman speed records
6. Nakamoto, S. — Bitcoin: A Peer-to-Peer Electronic Cash System
